const express = require('express');
const app = express();

const mongoose = require('mongoose');
const ObjectId = mongoose.Types.ObjectId;

const jwt = require('jsonwebtoken');
const bcrypt = require('bcrypt');

const secretKey = process.env.SECRET_KEY;

const validateEmail = require('../utils/user.js')

// dts_insert, dts_update 필드에 삽입할 변수 값 설정
const currentDate = new Date();
const dateString = currentDate.toISOString().slice(0, 10).replace(/-/g, "");    // 현재 날짜를 "yyyymmdd" 형식으로 설정
const timeString = currentDate.toTimeString().slice(0, 8).replace(/:/g, "");    // 현재 시간을 "hhmmss" 형식으로 설정

const userService = require('../services/userService');

const userController = {
    async getUserIdInfo (req, res, next) {
        try {
            const { user_id } = req.params;
            console.log(user_id);

            const findUser = await userService.getUserByIdInfo(user_id);

            if (!findUser) {
                return res.status(400).json({
                    resultCode: "404",
                    message: "해당 사용자를 찾을 수 없습니다."
                });
            }

            console.log(findUser + 'userController');
            return res.status(200).json({
                resultCode: "200", 
                message: "사용자 정보 조회 성공",
                data: {
                    user_id: findUser._id,
                    user_name: findUser.user_name,
                    email: findUser.email,
                    intro_yn: findUser.intro_yn,
                    phone_number: findUser.phone_number, 
                    file_key: findUser.file_key, 
                    file_name: findUser.file_name
                }
            });
        } catch (err) {
            console.error(err);
            res.status(500).json({
                resultCode: "500",
                message: "서버오류"
            });
        }
    }
}

module.exports = userController;
